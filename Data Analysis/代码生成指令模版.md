# 代码生成指令模版

你现在是资深的深度学习资深从业者，现在需要你完成一个 sleep stage classification 的深度学习训练。

要求该模型能通过一整组 5 分钟间隔采样的心率数据推导出不同时间段的 sleep stage。

训练数据集通过 csv 格式文件保存在`./data/shhs`，其中的主要数据为 timestamp，hr，sleep_stage。timestamp 的单位为秒，hr 单位为 bpm，sleep_stage 中数值与阶段之间的映射关系为：

```python
SLEEP_STAGE_MAP = {
    0: 0,  # wake··
    1: 1,  # light
    2: 1,  # light
    3: 2,  # deep
    4: 2,  # deep
    5: 3,  # REM
    6: 3,  # REM(maybe)
    9: 3,  # REM(maybe)
}
```

在 csv 数据处理阶段，需要将所有数据列的列名小写并去空格来完成列名去重。

在特征工程阶段，需要将数据时间窗口拉长到 15 分钟，并将该窗口的最大值、最小值、均值、最大最小差值等统计量加入到特征中。

请根据我的要求生成用于进行深度学习的 Python 工程代码。要求如下：

1. 需要分模块编写程序。
2. 需要详细的函数注释、函数参数注释、过程说明注释。
3. 需要配置的内容使用`dataclass`在`config.py`中实现，并在其后各个模块中调用`config`中的配置。
4. 使用`tqdm`来展示训练进度。
5. 使用`wandb`来进行训练跟踪。
6. 使用`pytorch`进行模型训练，并将最佳模型保存为`pth`文件。
7. 使用`logging`实现`log`输出到文件。
8. 需要将训练过程中的损失值变化、训练后验证的混淆矩阵、验证集中的数据类型分布等内容保存为图片。
9. 假设版本号`version`为`1.0.0`。训练完成的模型保存在`./model/1.0.0`目录下，文件名为 ssc_1.0.0.pth。log 文件保存在`./logs/1.0.0`目录下，文件名为`training_1.0.0.log`。训练结果图片信息保存在`./plots/1.0.0`目录下。
10. 使用中文回答我，但是在代码文件中使用英文注释。
